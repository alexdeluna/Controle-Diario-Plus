<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Controle DiÃ¡rio</title>

  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="visual.css">
</head>

<body>
<main class="app">

  <!-- HEADER -->
  <header class="app-header">
    <h1>Bem-vindo</h1>
    <p id="status-indicador">ğŸ”´ Turno inativo</p>

    <div class="datetime">
      <span id="current-date"></span>
      <span id="current-time"></span>
    </div>
  </header>

  <!-- MENU PRINCIPAL -->
  <section class="menu" id="menu-principal">

    <button class="menu-card" data-action="turno">
      <div class="icon icon-turno">ğŸš—</div>
      <div class="text">
        <h2>Gerenciar Turno</h2>
        <p>Inicie, acompanhe e finalize seu turno</p>
      </div>
    </button>

    <button class="menu-card" data-action="custos">
      <div class="icon icon-custos">ğŸ’¸</div>
      <div class="text">
        <h2>Custos</h2>
        <p>Registre combustÃ­vel e despesas</p>
      </div>
    </button>

    <button class="menu-card" data-action="resumos">
      <div class="icon icon-resumo">ğŸ“Š</div>
      <div class="text">
        <h2>Resumos</h2>
        <p>Resultados e histÃ³rico</p>
      </div>
    </button>

    <button class="menu-card" data-action="metas">
      <div class="icon icon-metas">ğŸ¯</div>
      <div class="text">
        <h2>Metas</h2>
        <p>Objetivos diÃ¡rios</p>
      </div>
    </button>

    <!--<button class="menu-card" data-action="manutencao">
      <div class="icon icon-manutencao">ğŸ› ï¸</div>
      <div class="text">
        <h2>ManutenÃ§Ã£o</h2>
        <p>Alertas do veÃ­culo</p>
      </div>
    </button> -->

  </section>

  <!-- MENU TURNO -->
  <section class="screen hidden" id="screen-menu-turno">

  <h2 class="screen-title">Gerenciar Turno</h2>

  <div class="screen-actions">

    <button class="btn btn-primary" id="btn-ir-iniciar-turno">
      Iniciar Turno
    </button>

    <button class="btn btn-danger" id="btn-ir-finalizar-turno">
      Finalizar Turno
    </button>

    <button class="btn btn-back" id="voltar-menu-principal">
      â† Voltar
    </button>
	<button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>

  </div>

</section>

  <!-- INICIAR TURNO -->
  <section class="screen hidden" id="screen-turno">
    <h2 class="screen-title">Iniciar Turno</h2>

    <div class="form-group">
      <label>Hora inicial</label>
      <div class="inline">
		<input type="time" id="hora-inicio">
		<button type="button" class="btn-secondary" id="btn-hora-atual">Agora</button>
		</div>
    </div>

    <div class="form-group">
      <label>KM inicial</label>
      <input type="number" id="km-inicial">
    </div>

    <button class="btn btn-primary" id="btn-iniciar-turno">Iniciar Turno</button>
    <p class="status-message" id="status-turno"></p>
    <button class="btn btn-back" id="voltar-menu-turno">â† Voltar</button>
	<button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
  </section>
  

  <!-- FINALIZAR TURNO -->
  <section class="screen hidden" id="screen-finalizar-turno">
    <h2 class="screen-title">Finalizar Turno</h2>

    <div class="form-group">
      <label>Hora final</label>
      <div class="inline">
		<input type="time" id="hora-fim">
		<button type="button" class="btn-secondary" id="btn-hora-final-atual">Agora</button>
		</div>
    </div>

    <div class="form-group">
      <label>KM final</label>
      <input type="number" id="km-final">
    </div>

    <div class="form-group">
      <label>Apurado (R$)</label>
      <input type="number" id="apurado" step="0.01">
    </div>

<button class="btn btn-primary" id="btn-finalizar-turno">Finalizar Turno</button>
    <p class="status-message" id="status-finalizar"></p>
<button class="btn btn-back" id="voltar-menu-finalizar">â† Voltar</button>
<button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
  </section>

<!-- MENU CUSTOS (PRINCIPAL) COM RESUMO -->
<section class="screen hidden" id="screen-menu-custos">
  <h2 class="screen-title">Custos</h2>
  
  <!-- NOVO BLOCO DE RESUMO RÃPIDO -->
  <div class="resumo-dia" style="background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 20px; text-align: center;">
    <p style="font-size: 14px; opacity: 0.8;">Resumo de hoje:</p>
    <p>â›½ Abastecimento: <strong id="resumo-custo-abast">R$ 0,00</strong></p>
    <p>ğŸ• Outros Custos: <strong id="resumo-custo-outros">R$ 0,00</strong></p>
    <hr style="margin: 10px 0; border: 0; border-top: 1px solid var(--gray);">
    <p>ğŸ’° Total: <strong id="resumo-custo-total" style="color: var(--orange); font-size: 1.2em;">R$ 0,00</strong></p>
  </div>

  <div class="screen-actions">
    <button class="btn btn-primary" id="btn-ir-abastecimento">Abastecimento</button>
    <button class="btn btn-warning" id="btn-ir-outros-custos">Outros Custos</button>
    <button class="btn btn-back" id="voltar-custos-principal">â† Voltar</button>
    <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
  </div>
</section>


<!-- TELA: ABASTECIMENTO -->
<section class="screen hidden" id="screen-abastecimento">
  <h2 class="screen-title">Abastecimento</h2>
  <div class="form-group">
    <label>Valor do Abastecimento (R$)</label>
    <input type="number" id="valor-abastecimento" placeholder="Ex: 50.00" step="0.01">
  </div>
  <button class="btn btn-primary" id="btn-salvar-abastecimento">Inserir Abastecimento</button>
  
  <div class="resumo-custo" style="margin-top:20px; text-align:center;">
    <p>Total abastecido hoje:</p>
    <h3 id="total-abastecido-dia">R$ 0,00</h3>
  </div>
  
  <button class="btn btn-back" id="voltar-menu-custos-abast">â† Voltar</button>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

<!-- TELA: OUTROS CUSTOS -->
<section class="screen hidden" id="screen-outros-custos">
  <h2 class="screen-title">Outros Custos</h2>
  
  <div class="form-group">
    <label>Tipo de Custo</label>
    <select id="tipo-custo" class="btn-secondary" style="width:100%; padding:12px; margin-bottom:10px;">
      <option value="Agua">Ãgua</option>
      <option value="Alimentacao">AlimentaÃ§Ã£o</option>
      <option value="Estacionamento">Estacionamento</option>
      <option value="Outros">Outros (Descrever)</option>
    </select>
  </div>

  <div class="form-group hidden" id="group-desc-outros">
    <label>DescriÃ§Ã£o</label>
    <input type="text" id="desc-custo-outros" placeholder="Ex: AlmoÃ§o no ZÃ©">
  </div>

  <div class="form-group">
    <label>Valor (R$)</label>
    <input type="number" id="valor-custo-outro" step="0.01">
  </div>

  <button class="btn btn-warning" id="btn-salvar-custo-outro">Adicionar Custo</button>

  <div class="lista-custos-container" style="margin-top:20px;">
    <p>Total de custos: <strong id="total-outros-valor">R$ 0,00</strong></p>
    <ul id="lista-detalhada-custos" style="list-style:none; padding:0; margin-top:10px;">
      <!-- Itens entrarÃ£o aqui via JS -->
    </ul>
  </div>

  <button class="btn btn-back" id="voltar-menu-custos-outros">â† Voltar</button>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

<!-- TELA ESCOLHA RESUMOS -->
<section class="screen hidden" id="screen-resumos">
  <h2 class="screen-title">Resumos</h2>
  <div class="screen-actions">
    <button class="btn btn-primary" id="btn-resumo-diario">Resumo DiÃ¡rio</button>
    <button class="btn btn-primary" id="btn-historico-geral">HistÃ³rico Geral</button>
    <button class="btn btn-back" id="voltar-menu-resumos">â† Voltar</button>
	<button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
  </div>
</section>

<!-- TELA RESUMO DIÃRIO -->
<section class="screen hidden" id="screen-resumo-diario">
  <h2 class="screen-title">Resumo DiÃ¡rio</h2>
  <div class="resumo-dia">
    <p><strong>Intervalo total:</strong> <span id="resumo-intervalo">--:--</span></p>
    <p><strong>KM total rodado:</strong> <span id="resumo-km">0</span> km</p>
    <p><strong>Total Abastecido:</strong> R$ <span id="resumo-abastecimento">0,00</span></p>
    <p><strong>Outros Custos:</strong> R$ <span id="resumo-outros">0,00</span></p>
    <p><strong>Valor Apurado:</strong> R$ <span id="resumo-apurado">0,00</span></p>
    <p><strong>Lucro do Dia:</strong> R$ <span id="resumo-lucro">0,00</span></p>
    <p><strong>Valor MÃ©dio da Hora:</strong> R$ <span id="resumo-hora">0,00</span> /h</p>
  </div>
  <button class="btn btn-back" id="voltar-resumo-diario">â† Voltar</button>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

<!-- TELA HISTÃ“RICO GERAL -->
<section class="screen hidden" id="screen-historico-geral">
  <h2 class="screen-title">HistÃ³rico Geral</h2>
  
  <div class="historico-botoes">
    <button class="btn btn-warning" id="export-pdf">Exportar PDF</button>
    <button class="btn btn-warning" id="export-excel">Exportar Excel</button>
  </div>

  <ul id="lista-historico" style="list-style:none; padding:0; margin-top:10px;">
    <!-- Cada turno serÃ¡ exibido aqui via JS -->
  </ul>

  <button class="btn btn-back" id="voltar-historico">â† Voltar</button>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

<!-- TELA: MENU DE METAS -->
<section class="screen hidden" id="screen-metas">
  <h2 class="screen-title">Metas</h2>
  <div class="screen-actions">
    <button class="btn btn-primary" id="btn-meta-mensal">ğŸ“… Meta Mensal</button>
    <button class="btn btn-primary" id="btn-meta-semanal">ğŸ—“ï¸ Meta Semanal</button>
    <button class="btn btn-primary" id="btn-meta-diaria">â˜€ï¸ Meta DiÃ¡ria</button>
    <button class="btn btn-primary" id="btn-meta-por-data">ğŸ¯ Meta por Data e Valor</button>
  </div>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

<!-- TELA: FORMULÃRIO META MENSAL -->
<section class="screen hidden" id="screen-meta-mensal">
  <h2 class="screen-title">Meta Mensal</h2>
  <div class="form-group">
    <label>Valor da Meta Mensal (R$)</label>
    <input type="number" id="input-meta-mensal" placeholder="Ex: 5000.00">
  </div>  
  <button class="btn btn-primary" id="btn-salvar-meta-mensal">Definir Meta</button>
  
  <!-- Onde o cÃ¡lculo "Faltam R$ XXX" aparece -->
  <div id="progresso-mensal" class="resumo-dia" style="margin-top:20px; background: var(--card); padding:15px; border-radius:12px; min-height: 50px;">
    <p style="opacity:0.5; text-align:center;">Aguardando definiÃ§Ã£o de meta...</p>
  </div>
  
  <button class="btn btn-back" id="voltar-metas-mensal">â† Voltar</button>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

<!-- TELA: FORMULÃRIO META SEMANAL -->
<section class="screen hidden" id="screen-meta-semanal">
  <h2 class="screen-title">Meta Semanal</h2>
  <div class="form-group">
    <label>Valor da Meta Semanal (R$)</label>
    <input type="number" id="input-meta-semanal" placeholder="Ex: 1500.00">
  </div>
  <button class="btn btn-primary" id="btn-salvar-meta-semanal">Definir Meta</button>
  
  <div id="progresso-semanal" class="resumo-dia" style="margin-top:20px; background: var(--card); padding:15px; border-radius:12px; min-height: 50px;">
    <p style="opacity:0.5; text-align:center;">Aguardando definiÃ§Ã£o de meta...</p>
  </div>
  
  <button class="btn btn-back" id="voltar-metas-semanal">â† Voltar</button>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

<!-- TELA: FORMULÃRIO META DIÃRIA -->
<section class="screen hidden" id="screen-meta-diaria">
  <h2 class="screen-title">Meta DiÃ¡ria</h2>
  <div class="form-group">
    <label>Meta para Hoje (R$)</label>
    <input type="number" id="input-meta-diaria" placeholder="Ex: 300.00">
  </div>
  <button class="btn btn-primary" id="btn-salvar-meta-diaria">Definir Meta</button>
  
  <div id="progresso-diario" class="resumo-dia" style="margin-top:20px; background: var(--card); padding:15px; border-radius:12px; text-align: center; min-height: 50px;">
    <p style="opacity:0.5;">Aguardando definiÃ§Ã£o de meta...</p>
  </div>
  
  <button class="btn btn-back" id="voltar-metas-diaria">â† Voltar</button>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

<!-- TELA: FORMULÃRIO META POR DATA E VALOR -->
<section class="screen hidden" id="screen-meta-data-valor">
  <h2 class="screen-title">Meta por Data</h2>
  <div class="form-group">
    <label>TÃ­tulo (Ex: CartÃ£o Visa)</label>
    <input type="text" id="meta-data-titulo" placeholder="Nome da meta">
  </div>
  <div class="form-group">
    <label>Valor Alvo (R$)</label>
    <input type="number" id="meta-data-valor" placeholder="1350.00">
  </div>
  <div class="form-group">
    <label>Data Limite</label>
    <input type="date" id="meta-data-limite">
  </div>
  <button class="btn btn-primary" id="btn-salvar-meta-data">Criar Meta Especial</button>

  <div id="lista-metas-data" style="margin-top:20px;">
    <!-- Lista de metas individuais aparecerÃ¡ aqui via renderizarMetasPorData() -->
  </div>

  <button class="btn btn-back" id="voltar-metas-data">â† Voltar</button>
  <button class="btn btn-home" onclick="showScreen(screens.menu)">ğŸ  Menu Inicial</button>
</section>

</main>

  <!-- Links COMPLETOS para as bibliotecas de exportaÃ§Ã£o (CORREÃ‡ÃƒO AQUI) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<script src="app.js"></script>

<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('sw.js')
        .then(reg => console.log('Service Worker registrado!', reg))
        .catch(err => console.log('Erro ao registrar Service Worker', err));
    });
  }
</script>

</body>
</html>
